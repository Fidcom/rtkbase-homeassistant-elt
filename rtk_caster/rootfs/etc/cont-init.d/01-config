#!/usr/bin/with-contenv bashio

# Configure the application
CONFIG_PATH=/data/options.json
GNSS_IP=$(bashio::config 'gnss_ip')
GNSS_PORT=$(bashio::config 'gnss_port')
NTRIP_PORT=$(bashio::config 'ntrip_port')

SETTINGS_FILE=/usr/local/rtkbase/rtkbase/settings.conf

# Update settings.conf with values from options.json
sed -i "s/^tcp_ip = .*/tcp_ip = ${GNSS_IP}/" "${SETTINGS_FILE}"
sed -i "s/^tcp_port = .*/tcp_port = ${GNSS_PORT}/" "${SETTINGS_FILE}"
sed -i "s/^local_caster_port = .*/local_caster_port = ${NTRIP_PORT}/" "${SETTINGS_FILE}"
